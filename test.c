#include "SHA3api_ref.h"
#include <stdio.h>
#include <string.h>

#define T(d, r) { .data = d, .result = r, .datalen = 8 * (sizeof(d) - 1), }
#define TN(n, d, r) { .data = d, .result = r, .datalen = n, }

static struct {
	unsigned char *data, *result;
	size_t datalen;
} tests[] = {
	T("",
	  "\xD3\xF7\x26\x3A\x09\x83\x7F\x4C\xE5\xC8\xEF\x70\xA5\xDD\xFF\xAC\x7B\x92\xD6\xC2\xAC\xE5\xA1\x22\x65\xBD\x5B\x59\x32\x60\xA3\xFF\x20\xD8\xB4\xB4\xC5\x49\x4E\x94\x54\x48\xB3\x7A\xBB\x1F\xC5\x26\xF6\xB4\x60\x89\x20\x8F\xDE\x93\x8D\x7F\x23\x72\x4C\x4B\xDF\xB7"),
	T("\xff",
	  "\x8F\xCA\x8D\x27\x05\xF9\x9A\x56\x90\x43\x08\xA4\x00\x4C\x64\xEF\xB6\x68\x81\x8B\x58\xB0\x89\x5B\xF7\x29\x6A\x2C\x5A\x54\xF9\x30\x14\x83\xD6\x22\xC4\xA5\xAE\xC8\x55\xAC\x30\x08\x7E\x1E\xB0\xE8\x39\x40\x90\x6E\x7B\x05\x5D\x70\xD4\x46\xC8\xD2\x85\xF2\x7F\x01"),
	T("\xFF\xFE\xFD\xFC\xFB\xFA\xF9\xF8\xF7\xF6\xF5\xF4\xF3\xF2\xF1\xF0\xEF\xEE\xED\xEC\xEB\xEA\xE9\xE8\xE7\xE6\xE5\xE4\xE3\xE2\xE1\xE0\xDF\xDE\xDD\xDC\xDB\xDA\xD9\xD8\xD7\xD6\xD5\xD4\xD3\xD2\xD1\xD0\xCF\xCE\xCD\xCC\xCB\xCA\xC9\xC8\xC7\xC6\xC5\xC4\xC3\xC2\xC1\xC0",
	  "\x0F\xC4\x2E\x10\x0B\x2C\xD0\xB0\xC6\x9F\x39\x38\x3F\x9D\x2D\x17\xAF\x6C\xF7\x4E\x2A\xA8\xD4\xE2\xD9\x1C\xBF\x94\xA5\x99\x35\xA3\x12\x3B\x7F\x92\x50\xF9\x82\x22\x4B\xF0\xC3\xE1\x90\xBE\x10\xAB\x41\xAD\xD8\xC1\xE3\x5C\xBE\xC4\xB1\xB3\xC3\x5D\xBB\xA5\x86\x9C"),
	T("\xFF\xFE\xFD\xFC\xFB\xFA\xF9\xF8\xF7\xF6\xF5\xF4\xF3\xF2\xF1\xF0\xEF\xEE\xED\xEC\xEB\xEA\xE9\xE8\xE7\xE6\xE5\xE4\xE3\xE2\xE1\xE0\xDF\xDE\xDD\xDC\xDB\xDA\xD9\xD8\xD7\xD6\xD5\xD4\xD3\xD2\xD1\xD0\xCF\xCE\xCD\xCC\xCB\xCA\xC9\xC8\xC7\xC6\xC5\xC4\xC3\xC2\xC1\xC0\xBF\xBE\xBD\xBC\xBB\xBA\xB9\xB8\xB7\xB6\xB5\xB4\xB3\xB2\xB1\xB0\xAF\xAE\xAD\xAC\xAB\xAA\xA9\xA8\xA7\xA6\xA5\xA4\xA3\xA2\xA1\xA0\x9F\x9E\x9D\x9C\x9B\x9A\x99\x98\x97\x96\x95\x94\x93\x92\x91\x90\x8F\x8E\x8D\x8C\x8B\x8A\x89\x88\x87\x86\x85\x84\x83\x82\x81\x80", 
	  "\x0F\x01\x9E\x7C\x18\x49\x16\x7C\xEC\xB9\xA0\xD8\xF1\xB0\x0C\xCD\x5B\x14\x15\x9C\x5A\xAE\xE4\x49\xDA\xB5\x5A\x1B\xC6\xC8\x51\x03\xE8\x37\x84\x54\x91\x2E\x46\xAF\x63\x06\x79\x50\xF8\x63\x04\x3C\xCF\xA3\x69\x98\x87\xA2\x57\x73\x37\xCA\xA6\x65\x31\xBD\xBF\x9E"),
//	T("\x00\x02\x02\x02\x04\x02\x06\x02\x08\x02\x0A\x02\x0C\x02\x0E\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1A\x02\x1C\x02\x1E\x02\x20\x02\x22\x02\x24\x02\x26\x02\x28\x02\x2A\x02\x2C\x02\x2E\x02\x30\x02\x32\x02\x34\x02\x36\x02\x38\x02\x3A\x02\x3C\x02\x3E\x02\x40\x02\x42\x02\x44\x02\x46\x02\x48\x02\x4A\x02\x4C\x02\x4E\x02\x50\x02\x52\x02\x54\x02\x56\x02\x58\x02\x5A\x02\x5C\x02\x5E\x02\x60\x02\x62\x02\x64\x02\x66\x02\x68\x02\x6A\x02\x6C\x02\x6E\x02\x70\x02\x72\x02\x74\x02\x76\x02\x78\x02\x7A\x02\x7C\x02\x7E\x02\x80\x02\x82\x02\x84\x02\x86\x02\x88\x02\x8A\x02\x8C\x02\x8E\x02\x90\x02\x92\x02\x94\x02\x96\x02\x98\x02\x9A\x02\x9C\x02\x9E\x02\xA0\x02\xA2\x02\xA4\x02\xA6\x02\xA8\x02\xAA\x02\xAC\x02\xAE\x02\xB0\x02\xB2\x02\xB4\x02\xB6\x02\xB8\x02\xBA\x02\xBC\x02\xBE\x02\xC0\x02\xC2\x02\xC4\x02\xC6\x02\xC8\x02\xCA\x02\xCC\x02\xCE\x02\xD0\x02\xD2\x02\xD4\x02\xD6\x02\xD8\x02\xDA\x02\xDC\x02\xDE\x02\xE0\x02\xE2\x02\xE4\x02\xE6\x02\xE8\x02\xEA\x02\xEC\x02\xEE\x02\xF0\x02\xF2\x02\xF4\x02\xF6\x02\xF8\x02\xFA\x02\xFC\x02\xFE",
//	  "\x62\x6F\x4D\xAB\x85\xA2\x52\xFD\x07\x58\x15\xE9\x8C\x42\xD1\x7D\xE8\x36\xC7\x21\x68\x2A\x03\x2A\x78\x4F\xA4\xE8\xE9\x6F\x7A\x54\x22\xC4\xEB\xC7\x13\xD2\xAE\xE3\x1F\x31\xC9\x3B\x66\xB5\x90\xC5\x22\x34\xA9\xA9\xD6\x24\xE7\x89\x82\x34\x08\x23\xE6\xF7\x3D\x5D"),
//	T("\x00\x02\x02\x02\x04\x02\x06\x02\x08\x02\x0A\x02\x0C\x02\x0E\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1A\x02\x1C\x02\x1E\x02\x20\x02\x22\x02\x24\x02\x26\x02\x28\x02\x2A\x02\x2C\x02\x2E\x02\x30\x02\x32\x02\x34\x02\x36\x02\x38\x02\x3A\x02\x3C\x02\x3E\x02\x40\x02\x42\x02\x44\x02\x46\x02\x48\x02\x4A\x02\x4C\x02\x4E\x02\x50\x02\x52\x02\x54\x02\x56\x02\x58\x02\x5A\x02\x5C\x02\x5E\x02\x60\x02\x62\x02\x64\x02\x66\x02\x68\x02\x6A\x02\x6C\x02\x6E\x02\x70\x02\x72\x02\x74\x02\x76\x02\x78\x02\x7A\x02\x7C\x02\x7E\x02\x80\x02\x82\x02\x84\x02\x86\x02\x88\x02\x8A\x02\x8C\x02\x8E\x02\x90\x02\x92\x02\x94\x02\x96\x02\x98\x02\x9A\x02\x9C\x02\x9E\x02\xA0\x02\xA2\x02\xA4\x02\xA6\x02\xA8\x02\xAA\x02\xAC\x02\xAE\x02\xB0\x02\xB2\x02\xB4\x02\xB6\x02\xB8\x02\xBA\x02\xBC\x02\xBE\x02\xC0\x02\xC2\x02\xC4\x02\xC6\x02\xC8\x02\xCA\x02\xCC\x02\xCE\x02\xD0\x02\xD2\x02\xD4\x02\xD6\x02\xD8\x02\xDA\x02\xDC\x02\xDE\x02\xE0\x02\xE2\x02\xE4\x02\xE6\x02\xE8\x02\xEA\x02\xEC\x02\xEE\x02\xF0\x02\xF2\x02\xF4\x02\xF6\x02\xF8\x02\xFA\x02\xFC\x02\xFE\x02\x00\x03\x02\x03\x04\x03\x06\x03\x08\x03\x0A\x03\x0C\x03\x0E\x03\x10\x03\x12\x03\x14\x03\x16\x03\x18\x03\x1A\x03\x1C\x03\x1E\x03\x20\x03\x22\x03\x24\x03\x26\x03\x28\x03\x2A\x03\x2C\x03\x2E\x03\x30\x03\x32\x03\x34\x03\x36\x03\x38\x03\x3A\x03\x3C\x03\x3E\x03\x40\x03\x42\x03\x44\x03\x46\x03\x48\x03\x4A\x03\x4C\x03\x4E\x03\x50\x03\x52\x03\x54\x03\x56\x03\x58\x03\x5A\x03\x5C\x03\x5E\x03\x60\x03\x62\x03\x64\x03\x66\x03\x68\x03\x6A\x03\x6C\x03\x6E\x03\x70\x03\x72\x03\x74\x03\x76\x03\x78\x03\x7A\x03\x7C\x03\x7E\x03\x80\x03\x82\x03\x84\x03\x86\x03\x88\x03\x8A\x03\x8C\x03\x8E\x03\x90\x03\x92\x03\x94\x03\x96\x03\x98\x03\x9A\x03\x9C\x03\x9E\x03\xA0\x03\xA2\x03\xA4\x03\xA6\x03\xA8\x03\xAA\x03\xAC\x03\xAE\x03\xB0\x03\xB2\x03\xB4\x03\xB6\x03\xB8\x03\xBA\x03\xBC\x03\xBE\x03\xC0\x03\xC2\x03\xC4\x03\xC6\x03\xC8\x03\xCA\x03\xCC\x03\xCE\x03\xD0\x03\xD2\x03\xD4\x03\xD6\x03\xD8\x03\xDA\x03\xDC\x03\xDE\x03\xE0\x03\xE2\x03\xE4\x03\xE6\x03\xE8\x03\xEA\x03\xEC\x03\xEE\x03\xF0\x03\xF2\x03\xF4\x03\xF6\x03\xF8\x03\xFA\x03\xFC\x03\xFE\x03\x00\x00\x02\x00\x04\x00\x06\x00\x08\x00\x0A\x00\x0C\x00\x0E\x00\x10\x00\x12\x00\x14\x00\x16\x00\x18\x00\x1A\x00\x1C\x00\x1E\x00\x20\x00\x22\x00\x24\x00\x26\x00\x28\x00\x2A\x00\x2C\x00\x2E\x00\x30\x00\x32\x00\x34\x00\x36\x00\x38\x00\x3A\x00\x3C\x00\x3E\x00\x40\x00\x42\x00\x44\x00\x46\x00\x48\x00\x4A\x00\x4C\x00\x4E\x00\x50\x00\x52\x00\x54\x00\x56\x00\x58\x00\x5A\x00\x5C\x00\x5E\x00\x60\x00\x62\x00\x64\x00\x66\x00\x68\x00\x6A\x00\x6C\x00\x6E\x00\x70\x00\x72\x00\x74\x00\x76\x00\x78\x00\x7A\x00\x7C\x00\x7E\x00\x80\x00\x82\x00\x84\x00\x86\x00\x88\x00\x8A\x00\x8C\x00\x8E\x00\x90\x00\x92\x00\x94\x00\x96\x00\x98\x00\x9A\x00\x9C\x00\x9E\x00\xA0\x00\xA2\x00\xA4\x00\xA6\x00\xA8\x00\xAA\x00\xAC\x00\xAE\x00\xB0\x00\xB2\x00\xB4\x00\xB6\x00\xB8\x00\xBA\x00\xBC\x00\xBE\x00\xC0\x00\xC2\x00\xC4\x00\xC6\x00\xC8\x00\xCA\x00\xCC\x00\xCE\x00\xD0\x00\xD2\x00\xD4\x00\xD6\x00\xD8\x00\xDA\x00\xDC\x00\xDE\x00\xE0\x00\xE2\x00\xE4\x00\xE6\x00\xE8\x00\xEA\x00\xEC\x00\xEE\x00\xF0\x00\xF2\x00\xF4\x00\xF6\x00\xF8\x00\xFA\x00\xFC\x00\xFE\x00\x00\x01\x02\x01\x04\x01\x06\x01\x08\x01\x0A\x01\x0C\x01\x0E\x01\x10\x01\x12\x01\x14\x01\x16\x01\x18\x01\x1A\x01\x1C\x01\x1E\x01\x20\x01\x22\x01\x24\x01\x26\x01\x28\x01\x2A\x01\x2C\x01\x2E\x01\x30\x01\x32\x01\x34\x01\x36\x01\x38\x01\x3A\x01\x3C\x01\x3E\x01\x40\x01\x42\x01\x44\x01\x46\x01\x48\x01\x4A\x01\x4C\x01\x4E\x01\x50\x01\x52\x01\x54\x01\x56\x01\x58\x01\x5A\x01\x5C\x01\x5E\x01\x60\x01\x62\x01\x64\x01\x66\x01\x68\x01\x6A\x01\x6C\x01\x6E\x01\x70\x01\x72\x01\x74\x01\x76\x01\x78\x01\x7A\x01\x7C\x01\x7E\x01\x80\x01\x82\x01\x84\x01\x86\x01\x88\x01\x8A\x01\x8C\x01\x8E\x01\x90\x01\x92\x01\x94\x01\x96\x01\x98\x01\x9A\x01\x9C\x01\x9E\x01\xA0\x01\xA2\x01\xA4\x01\xA6\x01\xA8\x01\xAA\x01\xAC\x01\xAE\x01\xB0\x01\xB2\x01\xB4\x01\xB6\x01\xB8\x01\xBA\x01\xBC\x01\xBE\x01\xC0\x01\xC2\x01\xC4\x01\xC6\x01\xC8\x01\xCA\x01\xCC\x01\xCE\x01\xD0\x01\xD2\x01\xD4\x01\xD6\x01\xD8\x01\xDA\x01\xDC\x01\xDE\x01\xE0\x01\xE2\x01\xE4\x01\xE6\x01\xE8\x01\xEA\x01\xEC\x01\xEE\x01\xF0\x01\xF2\x01\xF4\x01\xF6\x01\xF8\x01\xFA\x01\xFC\x01",
//	  "\xEE\x00\x4B\xC2\x6E\x92\x63\xE3\x41\x76\xFE\xC1\x81\x79\x57\x49\x68\x9C\x63\xA8\x95\xA3\x42\x71\x8C\xAC\x70\xEE\x3C\xF0\x24\xC3\xB0\x90\x52\x55\xE8\x8F\xD4\x0F\xF0\xE2\xBB\x89\x9C\xB4\xA6\x90\x8F\xFE\xD9\x28\x22\x03\x7D\x20\xAB\xC9\x71\xCD\xFF\x7E\xE9\x83"),
	TN(1025, "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
		 "\xA5\x42\x44\x26\x64\x79\x71\xA1\x2C\x01\x67\xC0\xF7\x8A\x85\xC2\x1F\x62\x92\x0B\xC3\x96\xBC\xE0\x67\x1E\x42\xF9\x91\x2D\x8C\x43\xE6\xA3\xDD\xE5\xEC\xE7\xA2\xE8\x17\xC7\xD1\xAA\xFA\xC3\xFE\xFC\x2F\x36\x6B\x05\xC0\x60\x9A\x02\x30\x20\x36\x41\x95\xCB\xBC\x04"),
};

#define NT (sizeof(tests)/sizeof(tests[0]))

int main(void)
{
	BitSequence hash[512 / 8];
	int i;
	for (i = 0; i < NT; i++) {
		Hash(512, tests[i].data, tests[i].datalen, hash);
		printf("nbits = %d\n", tests[i].datalen);
		if (memcmp(tests[i].result, &hash, sizeof(hash)))
		        printf("FAIL %d!\n", i);
	}
	return 0;
}
